
<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<meta name="description" content="">
		<meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
		<meta name="generator" content="Jekyll v3.8.5">
		<title>Sign Up</title>

		<!-- Bootstrap core CSS -->
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
		<script src="login.js"></script>
		<script src="userStatus.js"></script>
		<style>
			.bd-placeholder-img {
				font-size: 1.125rem;
				text-anchor: middle;
				-webkit-user-select: none;
				-moz-user-select: none;
				-ms-user-select: none;
				user-select: none;
			}

			@media (min-width: 768px) {
				.bd-placeholder-img-lg {
					font-size: 3.5rem;
				}
			}
			
			.sidenav {
				height: 120%;
				width: 700px;
				position: fixed;
				z-index: 1;
				top: 0;
				right: 0;
				background-color: #ffffff;
				overflow-x: hidden;
				transition: 0.5s;
				padding-top: 80px;
			}

			.sidenav a {
				padding: 8px 8px 8px 32px;
				text-decoration: none;
				font-size: 25px;
				color: #818181;
				display: block;
				transition: 0.3s;
			}

			.sidenav a:hover {
				color: #f1f1f1;
			}

			.sidenav .closebtn {
				position: absolute;
				top: 0;
				right: 25px;
				font-size: 30px;
				margin-left: 50px;
				padding-top: 60px;
			}
		</style>
		<!-- Custom styles for this template -->
		<link href="jumbotron.css" rel="stylesheet">
	</head>
	<body>
		<nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
			<a class="navbar-brand ml-3" href="index.html">&#10086; EasyMeals</a>
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>

			<div class="collapse navbar-collapse" id="navbarsExampleDefault">
				<ul class="navbar-nav ml-auto mr-3 w-100 justify-content-end">
					<li class="nav-item active">
						<a class="nav-link" href="Index.html">Home <span class="sr-only">(current)</span></a>
					</li>
					<li id="accountItem" class="nav-item">
						<a class="nav-link" href="Account.html">Account</a>
					</li>
					<li id="savedRecipes" class="nav-item">
						<a class="nav-link" href="javascript:void(0)">Saved Recipes</a>
					</li>
					<li id="signInItem"	class="nav-item" style="padding-right: 20px">
						<a class="nav-link" onclick="openNavLog()">Sign in</a>
					</li>
					<li id="signUpItem"	class="nav-item active">
						<a class="nav-link btn-primary rounded" href="SignUp.html" role="button" style="width: 150px;text-align: center;">Sign up &#9753;</a>
					</li>
					<li id="logOutItem"	class="nav-item">
						<a class="nav-link" href="index.html">Log out</a>
					</li>
				</ul>
    
			</div>
		</nav>

		<main role="main">

			<!-- Main jumbotron for a primary marketing message or call to action -->
			<div class="jumbotron border" style="margin-top: 250px;margin-right: 570px;background-color:#ffffff">
				<div class="container">
					<h1 class="display-1" style="margin-bottom: 20px;font-weight: bolder;">By Signing Up </h1>
					<br/>
					<h1 class="display-4" style="margin-bottom: 20px;font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;You can save your favourite recipes,</h1>
					<br/>
					<h1 class="display-5" style="margin-bottom: 20px;font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;with just one click!</h1>
				</div>
			</div>
		</main>
		
		<!-- sideBar Login -->
		<div id="mySidenavLogin" class="sidenav text-center border-left">			
			<a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
			<div class="py-5 text-center">			
				<h4 class="font-weight-bold">Welcome to EasyMeals</h4>
			</div>
			<div class="col-md-9 order-md-1" style="margin: auto">      
					<div class="mb-3">
						<label for="email">Email</label>
						<input type="email" class="form-control" id="emailLogin" placeholder="you@example.com" value="" required="">
						<div class="invalid-feedback">
							Please enter a valid email address.
						</div>
					</div>
               
					<div class="mb-3">
						<label for="password">Password <span class="text-muted">(8 or more characters)</span></label>
						<input type="password" class="form-control" id="passwordLogin" placeholder="Password" value="" required="">
						<div class="invalid-feedback">
							Please enter a valid password.
						</div>
					</div>
					
					<hr class="mb-4">
					<button class="btn btn-primary btn-lg btn-default" type="submit" onclick="processLogin($('#emailLogin').val(),$('#passwordLogin').val())" >Login</button>
					
					<a href="SignUp.html" style="font-size: 15px;margin-right: 18px;text-decoration: underline;margin-top: 10px">Don't have an account? Sign up</a>
					
			</div>
			
			<div style="padding-top: 200px" ></div>
			
			<div style="height: 200px;padding-top: 50px;background:url('Images/footer.jpg');background-size: contain;">
				<h6>© 2019 EasyMeals</h6>
			</div>	
			
		</div>
		
		<!-- sideBar Registration -->
		<div id="mySidenav" class="sidenav text-center border-left">			
			<a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
			<div class="py-5 text-center">			
				<h4 class="font-weight-bold">Welcome to EasyMeals</h4>
				<h5>Fill out the form to get started.</h5>
			</div>
			<div class="col-md-9 order-md-1" style="margin: auto">      
				<form class="needs-validation" novalidate="" id="register">        
					<div class="mb-3">
						<label for="email">Email</label>
						<input type="email" class="form-control" id="email" placeholder="you@example.com" value="" required="">
						<div class="invalid-feedback">
							Please enter a valid email address.
						</div>
					</div>
               
					<div class="mb-3">
						<label for="password">Password <span class="text-muted">(8 or more characters)</span></label>
						<input type="password" class="form-control" id="password" placeholder="Password" value="" required="">
						<div class="invalid-feedback">
							Please enter a valid password.
						</div>
					</div>
        
					<div class="mb-3">
						<label for="conpassword">Confirm Password</label>
						<input type="password" class="form-control" id="confirmPassword" placeholder="Confirm Password" value="" required="">
						<div class="invalid-feedback">
							Please re-enter your password.
						</div>
					</div>
					<div class="mb-3">
						<p id="errMsg"></p>
					</div>
					<hr class="mb-4">
					<button class="btn btn-primary btn-lg btn-default" type="submit">Get Started</button>
				</form>
			</div>
			
			<div style="padding-top: 200px" ></div>
			
			<div style="height: 200px;padding-top: 50px;background:url('Images/footer.jpg');background-size: contain;">
				<h6>© 2019 EasyMeals</h6>
			</div>	
			
		</div>

		<footer class="container" style="margin-top: 500px">
			<p>&copy; EasyMeals 2019</p>
		</footer>
		
		<script>
		
		function openNavReg() {
			document.getElementById("mySidenav").style.width = "700px";
		}
		
		function openNavLog() {
			document.getElementById("mySidenavLogin").style.width = "700px";
		}

		function closeNav() {
			document.getElementById("mySidenav").style.width = "0px";
			document.getElementById("mySidenavLogin").style.width = "0px";
		}
		
		$(function(){
			var status = getUserStatus();
			if(status == 'true'){
				$("#signInItem").hide();
				$("#signUpItem").hide();
				$("#accountItem").show();
				$("#logOutItem").show();
			}else{
				$("#signInItem").show();
				$("#signUpItem").show();
				$("#accountItem").hide();
				$("#logOutItem").hide();
			}
  			// jQuery methods go here...
			function queryByIngredient(naturalString){
				clearDisplay();
				var display = document.getElementById("results");
				var titleCard = document.getElementById("titleCard");
				var count = 1;
				$.ajax({
					url: 'http://localhost:8000/api/query/byNatural',
					type: 'POST',
					contentType: 'application/json',
					data: JSON.stringify({naturalString}),
					success: function(res){
						var text = "<div class='row'>";
						
						for(var i = 0; i < res.results.length;i++){
							var title = res.results[i].title;
							if(title.length>25){
								title = title.substring(0,25) + "...";
							}
							
							if(i%3 == 0){
								text += "</div>";
								if(i!=res.results.length-1){
									text+="<div class='row'>";
								}
							}
							text += "<div class='col-md-4 rounded'><h1 class='h5'>"+title+"</h1><p><img class='rounded' src='https://spoonacular.com/recipeImages/"+res.results[i].id+"-556x370.jpg' style='height: 250px'/></p><p><button name='viewRecipe' class='btn btn-secondary' role='button' value="+res.results[i].id+">View details &raquo;</button></p></div>"
							
						}
					titleCard.innerHTML = "Recipes";
					display.innerHTML+=text;
					$("button[name='viewRecipe']").click(function(){
						window.location.href = "RecipeDetails.html" + "#" + $(this).val();
					})
				}})
			}
			
			function clearDisplay(){
				var display = document.getElementById("results");
				var titleCard = document.getElementById("titleCard");
				display.innerHTML = "";
				titleCard.innerHTML = "";
			}
					
			var searchBtn = document.getElementById("searchBtn");
			$("#searchBtn").click(function(){
				queryByIngredient($("#searchData").val());
			})
			
			$("#logOutItem").click(function(){
				processLogOut();
			})
			
			$("#savedRecipes").click(function() {
				if(getUserStatus() == "true") {
					window.location.href = "SavedRecipes.html";
				} else {
					window.location.href = "SignUp.html";
				}
			})
			

			let username, password, confirmPassword;
            $("#register").submit(function(e) {
                e.preventDefault();
                username = $("#email").val();
                password = $("#password").val();
                confirmPassword = $("#confirmPassword").val();
                    if (password === confirmPassword && password.length >= 8) {



                        $.ajax({
                            url: 'http://localhost:8000/api/user/createUser/',
                            type: 'POST',
                            contentType: 'application/json',
                            data: JSON.stringify({
								username,
								password
                            }),
                            success: function(res) {
                                window.location.href = "Registration_Success.html";
                            },
                            error: function(res) {
                                $('#errMsg').html("This user already exists").css("color", "red");
                            }
                        });
                    } else {
                        $('#errMsg').html("Passwords do not match. Password needs to be 8 characters or higher").css("color", "red");
                    }
                
            })
		});
		

		</script>
	</body>
    
</html>
